{{ config(materialized='table', schema='arr_seed_prep', tags=['daily','prep_cr','accounting_od']) }}

select
    effective_from_date::date as effective_from_date,
    effective_to_date::date as effective_to_date,
    errata_id::varchar(32) as errata_id,
    acquisition_id::number(2) as acquisition_id,
    record_type_id::number(1) as record_type_id,
    salesforce_account_id::varchar(256) as salesforce_account_id,
    zuora_account_id::varchar(256) as zuora_account_id,
    invoice_owner_id::varchar(256) as invoice_owner_id,
    subscription_owner_id::varchar(256) as subscription_owner_id,
    opportunity_id::varchar(256) as opportunity_id,
    quote_id::varchar(18) as quote_id,
    subscription_id::varchar(64) as subscription_id,
    subscription_term_start_date::date as subscription_term_start_date,
    subscription_term_end_date::date as subscription_term_end_date,
    order_id::varchar(64) as order_id,
    order_action_id::varchar(256) as order_action_id,
    rate_plan_charge_id::varchar(256) as rate_plan_charge_id,
    order_metric_type::varchar(256) as order_metric_type,
    product_id::varchar(64) as product_id,
    product_rate_plan_charge_id::varchar(256) as product_rate_plan_charge_id,
    start_date::date as start_date,
    end_date::date as end_date,
    uom::varchar(256) as uom,
    quantity::number(38,2) as quantity,
    charge_type::varchar(256) as charge_type,
    generated_reason::varchar(256) as generated_reason,
    mrr_in_local_currency::number(38,4) as mrr_in_local_currency,
    mrr_in_usd::number(38,4) as mrr_in_usd,
    arr_in_local_currency::number(38,4) as arr_in_local_currency,
    arr_in_usd::number(38,4) as arr_in_usd,
    tcv_in_local_currency::number(38,4) as tcv_in_local_currency,
    tcv_in_usd::number(38,4) as tcv_in_usd,
    nrr_in_local_currency::number(38,4) as nrr_in_local_currency,
    nrr_in_usd::number(38,4) as nrr_in_usd,
    local_currency_name::varchar(256) as local_currency_name,
    local_currency_exchange_rate::number(38,5) as local_currency_exchange_rate,
    local_currency_exchange_rate_type::varchar(256) as local_currency_exchange_rate_type,
    billing_period::varchar(256) as billing_period,
    is_acquisition_arr_or_nrr::boolean as is_acquisition_arr_or_nrr,
    is_booking_arr_or_nrr::boolean as is_booking_arr_or_nrr,
    is_implicit_cancel_arr_or_nrr::boolean as is_implicit_cancel_arr_or_nrr,
    is_implicit_ending_arr_or_nrr::boolean as is_implicit_ending_arr_or_nrr,
    is_up_for_renewal_arr_or_nrr::boolean as is_up_for_renewal_arr_or_nrr,
    is_fx_adjustment_arr_or_nrr::boolean as is_fx_adjustment_arr_or_nrr,
    is_consolidation_arr_or_nrr::boolean as is_consolidation_arr_or_nrr,
    is_booking_acquisition_arr_or_nrr::boolean as is_booking_acquisition_arr_or_nrr,
    is_net_new_quantity::boolean as is_net_new_quantity,
    is_delta_quantity::boolean as is_delta_quantity,
    is_strategic_evaluation_arr_or_nrr::boolean as is_strategic_evaluation_arr_or_nrr,
    is_delta_nrr::boolean as is_delta_nrr,
    is_net_new_arr::boolean as is_net_new_arr,
    is_delta_arr::boolean as is_delta_arr,
    start_end_date_source::varchar(256) as start_end_date_source,
    change_reason::varchar(500) as change_reason,
    created_date::date as created_date,
    created_by::varchar(256) as created_by,
    updated_date::date as updated_date
    
from
    {{ ref('acc_additions_seed') }}
